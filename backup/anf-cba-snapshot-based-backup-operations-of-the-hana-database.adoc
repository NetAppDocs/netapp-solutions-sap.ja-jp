---
sidebar: sidebar 
permalink: backup/anf-cba-snapshot-based-backup-operations-of-the-hana-database.html 
keywords: snapshot backup, cba topology, file system, sap hana studio 
summary: このセクションでは、HANAデータベースに対してSnapshotベースのバックアップ処理を実行する方法について説明します。 
---
= HANAデータベースのSnapshotベースのバックアップ処理
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-create-backup-policies.html["対処方法：バックアップポリシーを作成します。"]



== HANAシステムにポリシーを割り当てます

スケジュールされたバックアップをアクティブ化するには、HANAシステムにバックアップポリシーを割り当てる必要があります。

. [ポリシーの割り当て]*>*[データボリューム]*に移動します。
+
image:anf-cba-image36.png["このスクリーンショットは、BlueXP > Backup and Recovery > Applications>システムの画面を示しています。データボリュームのドロップダウンが表示されます。"]

. [*Assign*] をクリックします。
+
image:anf-cba-image37.png["このスクリーンショットは、BlueXP > Backup and Recovery > Applications> Systemsの画面を示しています。[Assign selection]画面が表示されます。"]

. これでポリシーがHANAシステムに割り当てられ、スケジュールの定義に基づいてSnapshotバックアップが実行されます。
+
image:anf-cba-image38.png["このスクリーンショットは、BlueXP > Backup and Recovery > Applications> Systemsの画面を示しています。基本ポリシー情報が入力されます。"]





== オンデマンドのSnapshotバックアップを作成します

オンデマンドデータベースバックアップを作成するには、次の手順を実行します。

. CBAダッシュボードビューで、コンテキストメニューから*[オンデマンドバックアップ]*>*[データボリューム]*を選択します。
+
image:anf-cba-image39.png["完了している手順のスクリーンショット。"]

. [オンデマンドバックアップ]ダイアログで、*[ポリシーベース]*または*[ 1回のみ]*を選択します。
+
** Policy-Based *では、オンデマンドバックアップは、保持およびプリスクリプトおよびポストスクリプトの設定に関して、スケジュールされたバックアップと同様に処理されます。
** One time *では、特定の保持、特定のバックアップ名、特定のプリスクリプトとポストスクリプトを定義できます。


. この例では、ポリシーベースを選択したあと、次の手順でポリシーと保持を選択できます。
+
image:anf-cba-image40.png["完了している手順のスクリーンショット。"]

+
[Job Monitoring]ビューでは、さまざまなワークフローステップ、ステップの実行時間、および合計操作実行時間を確認できます。この例では、バックアップ処理に約1分かかりました。

+
image:anf-cba-image41.png["完了している手順のスクリーンショット。"]

+
image:anf-cba-image42.png["完了している手順のスクリーンショット。"]





== CBAトポロジビューでSnapshotバックアップ情報を確認します

CBAダッシュボードビューのコンテキストメニューで、*[View Topology]*を選択してバックアップの概要を開きます。

image:anf-cba-image43.png["完了している手順のスクリーンショット。"]

バックアップの概要には、CBAを使用して作成されたバックアップのリストが表示されます。


NOTE: バックアップ名は、バックアップポリシーで定義された形式に従います。同じ命名規則が、SAP HANAバックアップカタログのエントリとANFボリュームのSnapshot名にも使用されます。

image:anf-cba-image44.png["完了している手順のスクリーンショット。"]



== SAP HANA StudioでSnapshotバックアップ情報を確認します

SAP HANA MDC システムのストレージ Snapshot コピーを使用してバックアップを実行する場合は、データボリュームの Snapshot コピーが作成されます。このデータボリュームには、システムデータベースのデータおよびすべてのテナントデータベースのデータが含まれます。この物理アーキテクチャを反映するため、CBAがSnapshotバックアップを開始するたびに、SAP HANAはシステムデータベースとすべてのテナントデータベースの組み合わせバックアップを内部的に実行します。その結果、 SAP HANA のバックアップカタログに、システムデータベース用とテナントデータベース用に 1 つずつ、合計複数のバックアップエントリが作成されます。

SAP HANAバックアップカタログのCBAバックアップ名は、次の2つの図に示すように、[Comment]フィールドと[External Backup ID（EBID）]フィールドに保存されます。次の図は、システムデータベースとテナントデータベース PR1 を示しています。どちらの図でも、CommentフィールドとEBIDフィールドに保存されているCBAバックアップ名が強調表示されています。


NOTE: CBAは独自のバックアップのみを認識します。SAP HANA Studioなどで作成されたその他のバックアップは、SAP HANAカタログには表示されますが、CBAには表示されません。

image:anf-cba-image45.png["完了している手順のスクリーンショット。"]

image:anf-cba-image46.png["完了している手順のスクリーンショット。"]



== Azure PortalでSnapshotバックアップ情報を確認します

ANFボリュームのSnapshotバックアップ名には、CBAでバックアップ名として使用されている名前と同じ名前が使用されます。次の図に、 Azure portal と Snapshot backups for the database data volume を示します。

image:anf-cba-image47.png["この図は、AzureポータルとデータベースデータボリュームのSnapshotバックアップを示しています。"]

link:anf-cba-file-based-backup-operations-of-the-hana-database.html["次の記事：HANAデータベースのファイルベースのバックアップ処理"]
