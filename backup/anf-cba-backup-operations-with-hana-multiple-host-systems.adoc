---
sidebar: sidebar 
permalink: backup/anf-cba-backup-operations-with-hana-multiple-host-systems.html 
keywords: system replication, cba, hsr, multiple host, standby host 
summary: このセクションでは、HANAシステムレプリケーションを使用してバックアップ処理を実行する方法について説明します。 
---
= HANAマルチホストシステムでのバックアップ処理
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-backup-operations-with-hana-system-replication.html["以前：HANAシステムレプリケーションを使用したバックアップ処理"]

HANAデータベースでは、シングルホストシステムと同じ方法でSnapshotバックアップが実行されます。バックアップ処理のSQLコマンドをシステムデータベースでトリガーする必要があります。また、各ノードのすべてのデータボリュームの整合性を確保するために、すべてのHANAワーカーノードに対してHANAバックアップセーブポイントが作成されます。次の手順では、各データボリュームでストレージのSnapshot処理を実行する必要があります。



== スタンバイホストを使用しないHANAマルチホストシステム

スタンバイホストのないHANAマルチホストシステムは、HANAシングルホストシステムと同様の方法でCBAで構成されます。

. HANAプラグインは、HANAネームサーバとシステムデータベースが実行されているワーカーノードにインストールする必要があります。Indexserverを実行しているワーカーノードには、HANAプラグインは必要ありません。
. HDBのユーザストアキーは、HANAシングルホストシステムの場合と同様に、システムデータベース用に設定します。
. ストレージフットプリントの構成では、HANAシステムのすべてのデータボリュームを追加する必要があります。
+
次の例では、Data1、Data2、およびData3のボリュームを追加します。

+

NOTE: 各HANAホストのデータボリュームは、スタンバイホストの設定と同じ方法で各ホストにマウントする必要があります。Cloud Backup for Applicationsでは、バックアップに含まれるファイルのリストが作成されるため、HANAシステムに属するすべてのボリュームにアクセスできる必要があります。ANFのリージョン間レプリケーションまたはANFバックアップが有効になっている場合、単一ファイルのリストア処理にはファイルリストが必要です。

+
image:anf-cba-image111.png["次の図は、Nameserver/systemDBを実行するワーカーノードにHANAプラグインをインストールする方法を示しています。"]





== スタンバイホストを備えたHANAマルチホストシステム

現在のCBAバージョンでは、スタンバイホストを備えたHANAマルチホストシステムがサポートされています。これは、ネームサーバをスタンバイホストにフェイルオーバーしたあとに、障害が発生したホストが再起動され、同じOS構成、ファイルシステムマウント、HANAプラグインが表示されることを前提としています。

スタンバイホストを使用するHANAマルチホストシステムは、次の手順でCBAで設定します。

. HANAプラグインは、HANAネームサーバ/システムデータベースが実行されているワーカーノードにインストールする必要があります。
. HDBユーザストアキーは、システムデータベース（ネームサーバホスト）とスタンバイホストの2つのホストで構成されます。CBAキー設定のhost:port文字列はセミコロンで区切る必要があり、リストの先頭と末尾は二重引用符で囲む必要があります。hdbsqlクライアントは、ユーザストアキーの最初のエントリから開始し、データベースへの接続を試行します。エントリが機能しない場合は、次のエントリが使用されます。したがって、プライマリネームサーバホストを最初に、スタンバイホストをユーザストアキーの2番目のエントリとして設定することが重要です。
+
image:anf-cba-image112.png["このスクリーンショットは、適切な情報が入力された[Add User Store]画面を示しています。"]

. HANAシステムのすべてのデータボリュームをストレージフットプリントの構成に追加する必要があります。
+
次の図の例では、Data1ボリュームとData2ボリュームを追加する必要があります。

+
image:anf-cba-image113.png["この図は、ワーカーネームサーバとスタンバイにData1とData2を追加する方法を示しています。"]



スタンバイホストへのネームサーバのフェールオーバーの場合、障害が発生したホストは短時間で再起動され、以前と同じ設定になると想定されます。この場合、HANAプラグインとhdbsqlおよびhdbユーザストアコンポーネントを使用でき、引き続きバックアップ処理に使用できます。

前述のユーザーストア構成では'hdbsqlクライアントは現在のネームサーバホストを指す2番目のホストエントリを使用し'バックアップ処理を実行します

image:anf-cba-image114.png["この図は、障害が発生したVMが再起動され、スタンバイホストへのフェイルオーバー後に新しいスタンバイホストとして機能することを示しています。"]

link:anf-cba-where-to-find-additional-information-and-version-history.html["次へ：追加情報 およびバージョン履歴の参照先。"]
