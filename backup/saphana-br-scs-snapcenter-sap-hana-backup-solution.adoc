---
sidebar: sidebar 
permalink: backup/saphana-br-scs-snapcenter-sap-hana-backup-solution.html 
keywords: solution components, supported releases, configuration, enhancements 
summary: このセクションでは、この解決策 で使用されているコンポーネント、サポートされている SAP HANA のリリースと構成、および SnapCenter 4.6 の拡張機能について説明します。 
---
= SnapCenter SAP HANA Backup 解決策 の略
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:saphana-br-scs-snapcenter-architecture.html["以前のバージョン： SnapCenter アーキテクチャ。"]



== 解決策コンポーネント

SnapCenter Backup 解決策 for SAP HANA には、次の領域があります。

* ストレージベースの Snapshot コピーを使用した SAP HANA データのバックアップ：
+
** バックアップのスケジュール設定
** 保持管理
** 不要な SAP HANA バックアップカタログの削除


* 非データ・ボリューム（例： /hana/shared ）バックアップとストレージ・ベースの Snapshot コピー：
+
** バックアップのスケジュール設定
** 保持管理


* オフサイトのバックアップまたはディザスタリカバリロケーションへのレプリケーション：
+
** SAP HANA データの Snapshot バックアップ
** データボリューム以外のボリューム
** オフサイトのバックアップストレージに保持管理を設定
** 不要な SAP HANA バックアップカタログの削除


* ファイルベースのバックアップを使用したデータベースブロックの整合性チェック：
+
** バックアップのスケジュール設定
** 保持管理
** 不要な SAP HANA バックアップカタログの削除


* HANA データベースログバックアップの保持管理：
+
** データバックアップの保持に基づく保持管理
** 不要な SAP HANA バックアップカタログの削除


* HANA データベースの自動検出
* リストアとリカバリの自動化
* SAP HANA マルチテナントデータベースコンテナ（ MDC ）システムを使用したシングルテナントのリストア処理


データベースデータファイルのバックアップは、 SnapCenter と SAP HANA 向けプラグインを組み合わせて実行されます。このプラグインは、 SAP HANA データベースのバックアップ保存ポイントをトリガーして、プライマリストレージシステムで作成された Snapshot コピーが SAP HANA データベースの整合性のあるイメージに基づいて作成されるようにします。

SnapCenter では、 SnapVault または NetApp SnapMirror を使用して、整合性のあるデータベースイメージをオフサイトのバックアップまたはディザスタリカバリロケーションにレプリケートできます。フィーチャー（ Feature ）：通常は、プライマリストレージとオフサイトのバックアップストレージに異なる保持ポリシーが定義されます。SnapCenter はプライマリストレージでの保持を処理し、 ONTAP はオフサイトのバックアップストレージでの保持を処理します。

SnapCenter では、 SAP HANA 関連のすべてのリソースを完全にバックアップするために、ストレージベースの Snapshot コピーを使用して SAP HANA プラグインを使用し、データ以外のすべてのボリュームをバックアップすることもできます。非データ・ボリュームは、データベース・データ・バックアップとは別にスケジュール設定できるため、保持ポリシーや保護ポリシーを個別に設定することができます。

SAP HANA データベースは、ログバックアップを自動的に実行します。目標復旧時点に応じて、ログ・バックアップの保存場所に関するいくつかのオプションがあります。

* ログバックアップは、 NetApp MetroCluster ハイアベイラビリティ（ HA ）およびディザスタリカバリストレージソフトウェアを使用してデータを別の場所に同期的にミラーリングするストレージシステムに書き込まれます。
* ログバックアップのデスティネーションは、同じプライマリストレージシステムで設定し、 SnapMirror によって同期または非同期でセカンダリストレージにレプリケートできます。
* ログバックアップのデスティネーションは、 SnapVault を使用してデータベースバックアップをレプリケートする、同じオフサイトのバックアップストレージに設定できます。この構成では、オフサイトのバックアップストレージに、ログバックアップをオフサイトのバックアップストレージに書き込むことができるように、プライマリストレージと同様の可用性要件があります。


SAP では、ブロックの整合性チェックを実行するために、ストレージベースの Snapshot バックアップと週次ファイルベースのバックアップを組み合わせることを推奨しています。ブロック整合性チェックは、 SnapCenter 内から実行できます。設定可能な保持ポリシーに基づいて、 SnapCenter は、プライマリストレージでのデータファイルバックアップの削除、ログファイルバックアップ、および SAP HANA のバックアップカタログを管理します。


NOTE: SnapCenter はプライマリストレージでの保持を処理し、 ONTAP はセカンダリバックアップの保持を管理します。

次の図に、データベースとログのバックアップ構成の概要を示します。この図では、ログバックアップがオフサイトのバックアップストレージの NFS マウントに書き込まれます。

image:saphana-br-scs-image7.png["エラー：グラフィックイメージがありません"]

SnapCenter では、データボリューム以外のボリュームのストレージベースの Snapshot バックアップを実行する際に、次のタスクを実行します。

. データボリューム以外のストレージ Snapshot コピーの作成。
. データボリュームの SnapVault 更新または SnapMirror 更新の実行（設定されている場合）。
. 定義された保持ポリシーに基づいて、プライマリストレージのストレージ Snapshot コピーを削除します。


SAP HANA データベースのストレージベースの Snapshot バックアップを実行する場合、 SnapCenter は次のタスクを実行します。

. SAP HANA バックアップ保存ポイントを作成して、永続性レイヤに整合性のあるイメージを作成する。
. データボリュームのストレージ Snapshot コピーの作成。
. SAP HANA バックアップカタログへのストレージ Snapshot バックアップの登録。
. SAP HANA バックアップセーブポイントのリリース。
. データボリュームの SnapVault 更新または SnapMirror 更新の実行（設定されている場合）。
. 定義された保持ポリシーに基づいて、プライマリストレージのストレージ Snapshot コピーを削除します。
. プライマリまたはオフサイトのバックアップストレージにバックアップが存在しなくなった場合は、 SAP HANA のバックアップカタログのエントリを削除します。
. 保持ポリシーに基づいてバックアップが削除された場合、または手動で削除された場合、 SnapCenter は最も古いデータバックアップよりも古いログバックアップをすべて削除します。ログバックアップは、ファイルシステムと SAP HANA のバックアップカタログから削除されます。




== サポートされている SAP HANA リリースと構成

SnapCenter は、 NFS または FC 接続のネットアップストレージシステム（ AFF および FAS ）を使用した SAP HANA シングルホスト構成とマルチホスト構成、および NFS を使用した AWS 、 Azure 、 Google Cloud Platform 、 AWS FSX ONTAP で Cloud Volumes ONTAP を実行している SAP HANA システムをサポートしています。

SnapCenter は、次の SAP HANA アーキテクチャとリリースをサポートしています。

* SAP HANA の単一コンテナ： SAP HANA 1.0 SPS12
* SAP HANA マルチテナントデータベースコンテナ（ MDC ）のシングルテナント： SAP HANA 2.0 SPS3 以降
* SAP HANA マルチテナントデータベースコンテナ（ MDC ）の複数のテナント： SAP HANA 2.0 SPS4 以降




== SnapCenter 4.6 の機能強化

バージョン 4.6 以降の SnapCenter では、 HANA システムレプリケーション関係で設定された HANA システムの自動検出がサポートされます。各ホストは、物理 IP アドレス（ホスト名）とストレージレイヤ上の個々のデータボリュームを使用して設定されます。2 つの SnapCenter リソースが 1 つのリソースグループに統合されている場合、 SnapCenter はプライマリまたはセカンダリのホストを自動的に識別し、必要なバックアップ処理を適宜実行します。SnapCenter で作成された Snapshot とファイルベースのバックアップの保持の管理は、両方のホストで実行されます。これにより、現在のセカンダリホストでも古いバックアップが削除されるようになります。次の図に概要を示します。SnapCenter の HANA システムレプリケーション対応 HANA システムの構成と運用の詳細概要 については、を参照してください https://www.netapp.com/us/media/tr-4719.pdf["TR-4719 『 SAP HANA System Replication 、 Backup and Recovery with SnapCenter 』"^]。

image:saphana-br-scs-image8.png["エラー：グラフィックイメージがありません"]

link:saphana-br-scs-snapcenter-concepts-and-best-practices.html["次： SnapCenter の概念とベストプラクティス"]
