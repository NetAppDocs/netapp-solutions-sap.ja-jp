---
sidebar: sidebar 
permalink: backup/fsxn-backup-of-non-data-volumes.html 
keywords: non-data volume, restore, recover 
summary: 非データボリュームのバックアップは、SnapCenter とSAP HANAプラグインに統合された機能です。データベースインストールリソースと必要なログが残っていれば、データベースデータボリュームを保護して特定の時点にSAP HANAデータベースをリストアおよびリカバリするだけで十分です。 
---
= データボリューム以外のボリュームのバックアップ
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
非データボリュームのバックアップは、SnapCenter とSAP HANAプラグインに統合された機能です。

データベースインストールリソースと必要なログが残っていれば、データベースデータボリュームを保護して特定の時点にSAP HANAデータベースをリストアおよびリカバリするだけで十分です。

他のデータファイルのリストアが必要な状況からリカバリするには、 SAP HANA データベースのバックアップを補うために、データボリューム以外のボリュームに対する追加のバックアップ戦略を開発することを推奨します。固有の要件に応じて、非データボリュームのバックアップはスケジュールの頻度と保持の設定が異なる場合があります。また、非データファイルを変更する頻度も考慮する必要があります。たとえば、 HANA ボリューム「 /hana/shared 」には、実行可能ファイルと SAP HANA トレースファイルが格納されています。実行ファイルが変更されるのは SAP HANA データベースがアップグレードされた場合だけですが、 SAP HANA の問題を分析するためには、 SAP HANA のトレースファイルのバックアップ頻度を高くする必要があります。

SnapCenter の非データボリュームバックアップを使用すると、関連するすべてのボリュームの Snapshot コピーを数秒で作成でき、 SAP HANA データベースのバックアップと同じスペース効率化を実現できます。両者の違いは、 SAP HANA データベースとの SQL 通信は不要なことです。



=== データボリューム以外のリソースを設定

データボリューム以外のリソースを設定するには、次の手順を実行します。

. [リソース]タブで、[データボリュームではない]を選択し、[ SAP HANAデータベースの追加]をクリックします。
+
image:amazon-fsx-image60.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. SAP HANAデータベースの追加ダイアログのステップ1で、リソースタイプリストから非データボリュームを選択します。リソースの名前、およびリソースに使用する関連SIDとSAP HANAプラグインホストを指定し、[次へ]をクリックします。
+
image:amazon-fsx-image61.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. SVM とストレージボリュームをストレージ容量として追加し、次へをクリックします。
+
image:amazon-fsx-image62.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. 設定を保存するには、概要手順で[完了]をクリックします。
+
image:amazon-fsx-image63.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+
これで、新しい非データボリュームがSnapCenter に追加されます。新しいリソースをダブルクリックして、リソースの保護を実行します。

+
image:amazon-fsx-image64.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+
リソースの保護は、HANAデータベースのリソースで前述した方法と同じ方法で行われます。

. [今すぐバックアップ]をクリックして、バックアップを実行できるようになりました。
+
image:amazon-fsx-image65.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. ポリシーを選択し、バックアップ処理を開始します。
+
image:amazon-fsx-image66.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



SnapCenter ジョブログには、個々のワークフロー手順が表示されます。

image:amazon-fsx-image67.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

これで、新しいバックアップがデータボリューム以外のリソースのリソースビューに表示されます。

image:amazon-fsx-image68.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



= リストアとリカバリ

SnapCenter では、単一テナントのHANAシングルホストMDCシステムに対して自動リストア処理とリカバリ処理がサポートされます。複数のテナントを持つマルチホストシステムまたはMDCシステムの場合は、SnapCenter はリストア処理のみを実行し、手動でリカバリを実行する必要があります。

リストア処理とリカバリ処理の自動化は、次の手順で実行できます。

. リストア処理に使用するバックアップを選択します。
. リストアタイプを選択します。[Complete Restore with Volume Revert or Without Volume Revert] を選択します。
. 次のオプションからリカバリタイプを選択します。
+
** を最新の状態に変更します
** ポイントインタイム
** 特定のデータのバックアップ
** リカバリなし
+
選択したリカバリタイプは、システムとテナントデータベースのリカバリに使用されます。





次に、 SnapCenter は次の処理を実行します。

. HANA データベースが停止します。
. データベースがリストアされます。選択したリストアタイプに応じて、異なる処理が実行されます。
+
** ボリューム復元が選択されている場合、SnapCenter はボリュームをアンマウントし、ストレージレイヤのボリュームベースSnapRestore を使用してボリュームを復元し、ボリュームをマウントします。
** ボリュームリバートを選択しない場合、SnapCenter は、ストレージレイヤで単一ファイルのSnapRestore 処理を使用してすべてのファイルをリストアします。


. データベースをリカバリします。
+
.. システムデータベースをリカバリする
.. テナントデータベースをリカバリします
.. HANAデータベースを起動しています
+
No Recoveryを選択すると、SnapCenter が終了し、システムとテナントデータベースのリストア処理を手動で実行する必要があります。





手動でリストアを実行するには、次の手順を実行します。

. SnapCenter で、リストア処理に使用するバックアップを選択します。
+
image:amazon-fsx-image69.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. リストアの範囲とタイプを選択します。
+
HANA MDCのシングルテナントシステムの標準的なシナリオは、ボリュームをリバートしてリソース全体を使用する場合です。複数のテナントを使用するHANA MDCシステムでは、単一のテナントのみをリストアできます。単一テナントのリストアの詳細については、を参照してくださいlink:hana-br-scs-restore-recovery.html["リストアとリカバリ（netapp.com）"^]。

+
image:amazon-fsx-image70.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. Recovery Scope を選択し、ログバックアップとカタログバックアップの場所を指定します。
+
SnapCenter では、 HANA の global.ini ファイルのデフォルトパスまたは変更されたパスを使用して、ログとカタログのバックアップの場所が事前に入力されます。

+
image:amazon-fsx-image71.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. オプションのリストア前のコマンドを入力します。
+
image:amazon-fsx-image72.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. オプションのリストア後のコマンドを入力します。
+
image:amazon-fsx-image73.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. リストアおよびリカバリ操作を開始するには'[完了]をクリックします
+
image:amazon-fsx-image74.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+
SnapCenter によってリストアおよびリカバリ処理が実行されます。この例は、リストアジョブとリカバリジョブのジョブの詳細を表示しています。

+
image:amazon-fsx-image75.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]


